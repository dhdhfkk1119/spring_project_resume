{{> layout/header}}

<style>
    /* í™”ë©´ ë„ˆë¹„ê°€ 767.98px ì´í•˜ì¼ ë•Œ (Bootstrapì˜ md ë¶„ê¸°ì ) ì ìš©ë  ìŠ¤íƒ€ì¼ */
    @media (max-width: 767.98px) {
        /* * fs-5 í´ë˜ìŠ¤(í˜„ì¬ ì•„ì´ì½˜ í¬ê¸°)ë¥¼ ê°€ì§„ i íƒœê·¸ì˜ í°íŠ¸ í¬ê¸°ë¥¼
         * ê¸°ì¡´ë³´ë‹¤ ì•½ê°„ ì‘ì€ 1remìœ¼ë¡œ ì¡°ì ˆí•©ë‹ˆë‹¤.
         */
        i.fs-5 {
            font-size: 1rem !important;
        }
    }
</style>

<div class="container my-5" style="max-with:1200px">
    <div class="card shadow-sm">
        <!-- ì¹´ë“œ í—¤ë”: ì´ë ¥ì„œ ì œëª©ê³¼ ê°ì¢… ë²„íŠ¼ -->
        <div class="card-header bg-light py-3">
            <div class="d-flex justify-content-between align-items-center">
                <h1 class="text-truncate h4 mb-0">{{resume.resumeTitle}}</h1>

                {{#isOwner}} <!--ì†Œìœ ê¶Œ í™•ì¸-->
                    <div class="d-flex align-items-center gap-3">
                        <!-- ëª©ë¡ ë²„íŠ¼ -->
                        <a href="/resumes" class="text-primary" title="ëª©ë¡ìœ¼ë¡œ">
                            <i class="fa-solid fa-list fs-5"></i>
                        </a>
                        <!-- ìˆ˜ì • ë²„íŠ¼ -->
                        <a href="/resume/{{resume.resumeIdx}}/update-form" class="text-primary" title="ìˆ˜ì •í•˜ê¸°">
                            <i class="fa-solid fa-pen-to-square fs-5"></i>
                        </a>
                        <!-- ì‚­ì œ ë²„íŠ¼ -->
                        <form class="delete-form" action="/resume/{{resume.resumeIdx}}/delete" method="post">
                            <button type="submit" class="btn btn-link p-0" title="ì‚­ì œí•˜ê¸°" style="color: Tomato;">
                                <i class="fa-solid fa-trash fs-5"></i>
                            </button>
                        </form>
                    </div>
                {{/isOwner}}

            </div>
        </div>
        <hr>
        <!-- ì¹´ë“œ ë°”ë””: ê°œì¸ ì •ë³´ -->
        <div class="card-body">
            <h2 class="h5 border-bottom pb-2 mb-3">{{resume.member.username}}</h2>
            <div class="col mb-4 p-3 border rounded">
                <p><strong>ë‚˜ì´/ì„±ë³„:</strong> {{resume.member.age}}ì„¸ / {{resume.member.sex}}</p>
                <p><strong>ì—°ë½ì²˜:</strong> {{resume.member.phoneNumber}}</p>
                <p><strong>ì´ë©”ì¼:</strong> {{resume.member.email}}</p>
                <p><strong>ì£¼ì†Œ:</strong> {{resume.member.address}}</p>
            </div>

            <hr>

            <!-- ìê¸°ì†Œê°œ -->
            <h2 class="h5 border-bottom pb-2 mb-3 mt-4">ì†Œê°œê¸€</h2>
            <div class="p-3 bg-white border rounded">
                <!-- pre íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ë©´ ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì¤„ë°”ê¿ˆê³¼ ê³µë°±ì´ ê·¸ëŒ€ë¡œ ìœ ì§€ë©ë‹ˆë‹¤. -->
                <pre style="white-space: pre-wrap; word-wrap: break-word; font-family: inherit; font-size: 1rem;">{{resume.resumeContent}}</pre>
            </div>


            <h2 class="h5 border-bottom pb-2 mb-3 mt-4">ê²½ë ¥ì‚¬í•­</h2>

            <!-- ê²½ë ¥ì‚¬í•­ ìˆœíšŒí•˜ì—¬ ì¶œë ¥ -->
            {{#resume.careerList}}
                <div class="card mb-3">
                    <div class="card-body">
                        <h5 class="card-title">{{corpName}}</h5>
                        {{#position}}
                            <h6 class="card-subtitle mb-2 text-muted">{{position}}</h6>
                        {{/position}}

                        {{#startAt}}
                            {{#endAt}}
                                <p class="card-text"><small class="text-muted">{{startAt}} ~ {{endAt}}</small></p>
                            {{/endAt}}
                            {{^endAt}}
                                <p class="card-text"><small class="text-muted">{{startAt}} ~</small></p>
                            {{/endAt}}
                        {{/startAt}}
                        {{^startAt}}
                            {{#endAt}}
                                <p class="card-text"><small class="text-muted">~ {{endAt}}</small></p>
                            {{/endAt}}
                        {{/startAt}}

                        <p class="card-text" style="white-space: pre-wrap;">{{careerContent}}</p>
                    </div>
                </div>
            {{/resume.careerList}}

            <!-- ê²½ë ¥ì‚¬í•­ ì—†ì„ ë•Œ ë‚˜ì˜¤ëŠ” ë©”ì„¸ì§€ -->
            {{^resume.careerList}}
                <div class="text-center p-3 border rounded">
                    <p class="mb-0">ì…ë ¥ëœ ê²½ë ¥ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            {{/resume.careerList}}
        </div>

        <!-- ëª©ë¡ ìˆ˜ì • ì‚­ì œ ë¦¬ìŠ¤íŠ¸ -->
        <div class="card-footer bg-transparent py-3">
            <div class="d-flex justify-content-between">
                <div>
                    <a href="#" id="back-btn" class="btn btn-outline-primary">ëª©ë¡ìœ¼ë¡œ</a>
                </div>
                {{#isOwner}}<!--ì†Œìœ ê¶Œ í™•ì¸-->
                    <div class="d-flex gap-2">
                        <a href="/resume/{{resume.resumeIdx}}/update-form" class="btn btn-outline-primary">ìˆ˜ì •í•˜ê¸°</a>
                        <form class="delete-form" action="/resume/{{resume.resumeIdx}}/delete" method="post">
                            <button type="button" id="delete-btn-text" class="btn btn-outline-danger">ì‚­ì œí•˜ê¸°</button>
                        </form>
                    </div>
                {{/isOwner}}
            </div>
        </div>


    </div>
</div>

<script>
    // ğŸ—‘ï¸âœ…ì‚­ì œí™•ì¸ì ˆì°¨
    document.querySelectorAll('.delete-form').forEach(form => {
        form.addEventListener('submit', function (event) {
            if (!confirm('ì •ë§ë¡œ ì´ ì´ë ¥ì„œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                event.preventDefault(); // 'ì·¨ì†Œ'ë¥¼ ëˆ„ë¥´ë©´ í¼ ì œì¶œì„ ë§‰ìŠµë‹ˆë‹¤.
            }
        });
    });

    // ğŸ—‘ï¸ğŸ”¥ ì‚­ì œ ì‹¤í–‰
    const deleteBtn = document.getElementById('delete-btn-text');
    if (deleteBtn) {
        deleteBtn.addEventListener('click', function () {
            this.closest('form').submit();
        });
    }

    // ğŸ“‹/â†©ï¸ ë²„íŠ¼ ë¡œì§
    const backBtn = document.getElementById('back-btn');
    if (backBtn) {
        backBtn.addEventListener('click', function(event) {
            event.preventDefault(); // a íƒœê·¸ ê¸°ë³¸ë™ì‘ ë§‰ê¸°

            // document.referrerëŠ” ì§ì „ í˜ì´ì§€ ì£¼ì†Œ í‘œì‹œ
            const referrer = document.referrer;

            // ì§ì „ í˜ì´ì§€ê°€ ìˆ˜ì •í™”ë©´(âœï¸)ì´ì—ˆë‹¤ë©´?
            if (referrer.includes('/update-form')) {
                // ğŸ“‹ëª©ë¡ìœ¼ë¡œ
                window.location.href = '/resumes';
            } else {
                // â†©ï¸ì•„ë‹ˆë©´ ë’¤ë¡œê°€ê¸°
                history.back();
            }
        });
    }
</script>

{{> layout/footer}}